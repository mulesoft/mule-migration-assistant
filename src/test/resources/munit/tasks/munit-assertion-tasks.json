{
  "tasks":
  [
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'assert') or contains(local-name(),'fail') or contains(local-name(),'run-custom')]",
      "taskDescriptor" : "Declare MUnit tools namespace on file and update assertion processors namespace",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Add munit tools namespace on file",
          "type" : "com.mulesoft.tools.migration.task.step.SetNodeNamespace",
          "parameters" : {
            "newNamespace" : "munit-tools",
            "newNamespaceUri" : "http://www.mulesoft.org/schema/mule/munit-tools",
            "schemaLocationUrl" : "http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xs"
          }
        },
        {
          "stepDescriptor" : "Remove all assertion namespace on nodes",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "assert-",
            "newValue" : ""
          }
        }
      ]
    },
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'on-equals')]",
      "taskDescriptor" : "Update MUnit Assert On Equals message processor",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Update assertion namespace",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
          "parameters" : {
            "nodeNamespace" : "munit-tools",
            "newNodeName" : "assert-that"
          }
        },
        {
          "stepDescriptor" : "Update attribute expectedValue to new DSL",
          "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "expectedValue",
            "newName" : "is"
          }
        },
        {
          "stepDescriptor" : "Update attribute actualValue to new DSL",
          "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "actualValue",
            "newName" : "expression"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'payload-equals')]",
      "taskDescriptor" : "Update MUnit Assert Payload Equals message processor",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Update assertion namespace",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
          "parameters" : {
            "nodeNamespace" : "munit-tools",
            "newNodeName" : "assert-that"
          }
        },
        {
          "stepDescriptor" : "Add new expression attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
          "parameters" : {
            "attributeName" : "expression",
            "attributeValue" : "#[payload]"
          }
        },
        {
          "stepDescriptor" : "Update attribute actualValue to new DSL",
          "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "expectedValue",
            "newName" : "is"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'not-null')]",
      "taskDescriptor" : "Update MUnit Assert Not Null message processor",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Update assertion namespace",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
          "parameters" : {
            "nodeNamespace" : "munit-tools",
            "newNodeName" : "assert-that"
          }
        },
        {
          "stepDescriptor" : "Add new expression attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
          "parameters" : {
            "attributeName" : "expression",
            "attributeValue" : "#[payload]"
          }
        },
        {
          "stepDescriptor" : "Add new is attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
          "parameters" : {
            "attributeName" : "is",
            "attributeValue" : "#[notNullValue()]"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'null')]",
      "taskDescriptor" : "Update MUnit Assert Not Null message processor",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Update assertion namespace",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
          "parameters" : {
            "nodeNamespace" : "munit-tools",
            "newNodeName" : "assert-that"
          }
        },
        {
          "stepDescriptor" : "Add new expression attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
          "parameters" : {
            "attributeName" : "expression",
            "attributeValue" : "#[payload]"
          }
        },
        {
          "stepDescriptor" : "Add new is attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
          "parameters" : {
            "attributeName" : "is",
            "attributeValue" : "#[nullValue()]"
          }
        }
      ]
    },
    {
    "xpathSelector" : "//munit:test/*[contains(local-name(),'false')]",
    "taskDescriptor" : "Update MUnit Assert False message processor",
    "stepsDefinition" : [
      {
        "stepDescriptor" : "Update assertion namespace",
        "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
        "parameters" : {
          "nodeNamespace" : "munit-tools",
          "newNodeName" : "assert-that"
        }
      },
      {
        "stepDescriptor" : "Update condition attribute to expression",
        "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
        "parameters" : {
          "attributeName" : "condition",
          "newName" : "expression"
        }
      },
      {
        "stepDescriptor" : "Add new is attribute for munit assertion DSL",
        "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
        "parameters" : {
          "attributeName" : "is",
          "attributeValue" : "#[equalTo(false)]"
        }
      }
    ]
    },
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'true')]",
      "taskDescriptor" : "Update MUnit Assert True message processor",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Update assertion namespace",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
          "parameters" : {
            "nodeNamespace" : "munit-tools",
            "newNodeName" : "assert-that"
          }
        },
        {
          "stepDescriptor" : "Update condition attribute to expression",
          "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "condition",
            "newName" : "expression"
          }
        },
        {
          "stepDescriptor" : "Add new is attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.AddAttribute",
          "parameters" : {
            "attributeName" : "is",
            "attributeValue" : "#[equalTo(true)]"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//munit:test/*[contains(local-name(),'not-same')]",
      "taskDescriptor" : "Update MUnit Assert Not Equals message processor",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Update assertion namespace",
          "type" : "com.mulesoft.tools.migration.task.step.ReplaceNodesName",
          "parameters" : {
            "nodeNamespace" : "munit-tools",
            "newNodeName" : "assert-that"
          }
        },
        {
          "stepDescriptor" : "Update expectedValue attribute to is",
          "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "expectedValue",
            "newName" : "is"
          }
        },
        {
          "stepDescriptor" : "Update actualValue attribute to expression",
          "type" : "com.mulesoft.tools.migration.task.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "actualValue",
            "newName" : "expression"
          }
        },
        {
          "stepDescriptor" : "Add new is attribute for munit assertion DSL",
          "type" : "com.mulesoft.tools.migration.task.step.NegateAttributeValue",
          "parameters" : {
            "attributeName" : "is"
          }
        }
      ]
    }
  ]
}


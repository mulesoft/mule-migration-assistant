{
  "tasks":
  [
    {
      "xpathSelector" : "//ws:*",
      "taskDescriptor" : "Update Webservice Consumer Namespace",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Delete 'ws' namespace",
          "type" : "com.mulesoft.tools.migration.library.step.DeleteNamespace",
          "parameters" : {
            "namespace" : "ws",
            "namespaceUri" : "http://www.mulesoft.org/schema/mule/ws",
            "schemaLocationUrl":"http://www.mulesoft.org/schema/mule/ws/current/mule-ws.xsd"
          }
        },
        {
          "stepDescriptor" : "Create 'wsc' namespace",
          "type" : "com.mulesoft.tools.migration.library.step.SetNodeNamespace",
          "parameters" : {
            "newNamespace" : "wsc",
            "newNamespaceUri" : "http://www.mulesoft.org/schema/mule/wsc",
            "schemaLocationUrl":"http://www.mulesoft.org/schema/mule/wsc/current/mule-wsc.xsd"
          }
        }

      ]
    },
    {
      "xpathSelector" : "//wsc:consumer",
      "taskDescriptor" : "Update Webservice Consumer - Consumer Components",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Move 'mtomEnabled' attribute to 'consumer-config'",
          "type" : "com.mulesoft.tools.migration.library.step.MoveAttribute",
          "parameters" : {
            "attribute" : "mtomEnabled",
            "targetNode" : "consumer-config",
            "targetNodeNamespace" : "wsc",
            "targetNodeNamespaceUri" : "http://www.mulesoft.org/schema/mule/wsc",
            "sourceReferenceAttribute" : "config-ref",
            "targetReferenceAttribute" : "name"
          }
        },
        {
          "stepDescriptor" : "Rename 'consumer' node name to 'consume'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "consumer",
            "newValue" : "consume"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:consumer-config",
      "taskDescriptor" : "Update Webservice Consumer - Consumer Configuration",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Create 'connection' child node",
          "type" : "com.mulesoft.tools.migration.library.step.CreateChildNode",
          "parameters" : {
            "name" : "connection"
          }
        },
        {
          "stepDescriptor" : "Rename 'serviceAddress' attribute name to 'address'",
          "type" : "com.mulesoft.tools.migration.library.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "serviceAddress",
            "newName" : "address"
          }
        },
        {
          "stepDescriptor" : "Move attributes to child node, service;port;wsdlLocation;address;mtomEnabled",
          "type" : "com.mulesoft.tools.migration.library.step.MoveAttributesToChildNode",
          "parameters" : {
            "attributes" : "service;port;wsdlLocation;address;mtomEnabled",
            "childNode" : "connection"
          }
        },
        {
          "stepDescriptor" : "Rename 'consumer-config' node name to 'config'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "consumer-config",
            "newValue" : "config"
          }
        },
        {
          "stepDescriptor" : "Move 'security' node to 'connection' child node",
          "type" : "com.mulesoft.tools.migration.library.step.MoveNodeToChildNode",
          "parameters" : {
            "sourceNode" : "security",
            "sourceNodeNamespace" : "wsc",
            "sourceNodeNamespaceUri" : "http://www.mulesoft.org/schema/mule/wsc",
            "targetNode" : "connection",
            "targetNodeNamespace" : "wsc",
            "targetNodeNamespaceUri" : "http://www.mulesoft.org/schema/mule/wsc"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:security",
      "taskDescriptor" : "Update Webservice Consumer - Security Configuration",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'security' node to 'security-strategies'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "security",
            "newValue" : "security-strategies"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:wss-username-token",
      "taskDescriptor" : "Update Webservice Consumer - WSS Username Token Strategy Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'wss-username-token' node name to 'wss-username-token-security-strategy'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "wss-username-token",
            "newValue" : "wss-username-token-security-strategy"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:wss-timestamp",
      "taskDescriptor" : "Update Webservice Consumer - WSS Timestamp Strategy Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'wss-timestamp' node name to 'wss-timestamp-security-strategy'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "wss-timestamp",
            "newValue" : "wss-timestamp-security-strategy"
          }
        },
        {
          "stepDescriptor" : "Rename expires attribute",
          "type" : "com.mulesoft.tools.migration.library.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "expires",
            "newName" : "timeToLive"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:wss-sign",
      "taskDescriptor" : "Update Webservice Consumer - WSS Sign Strategy Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'wss-sign' node name to 'wss-sign-security-strategy'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "wss-sign",
            "newValue" : "wss-sign-security-strategy"
          }
        },
        {
          "stepDescriptor" : "Create 'key-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.CreateChildNode",
          "parameters" : {
            "name" : "key-store-configuration"
          }
        },
        {
          "stepDescriptor" : "Move 'tlsContext-ref' attribute to 'key-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.MoveAttributeToChildNode",
          "parameters" : {
            "attribute" : "tlsContext-ref",
            "childNode" : "key-store-configuration"

          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:wss-verify-signature",
      "taskDescriptor" : "Update Webservice Consumer - WSS Verify Signature Strategy Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'wss-verify-signature' node name to 'wss-verify-signature-security-strategy'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "wss-verify-signature",
            "newValue" : "wss-verify-signature-security-strategy"
          }
        },
        {
          "stepDescriptor" : "Create 'trust-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.CreateChildNode",
          "parameters" : {
            "name" : "trust-store-configuration"
          }
        },
        {
          "stepDescriptor" : "Move 'tlsContext-ref' to 'trust-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.MoveAttributeToChildNode",
          "parameters" : {
            "attribute" : "tlsContext-ref",
            "childNode" : "trust-store-configuration"

          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:wss-encrypt",
      "taskDescriptor" : "Update Webservice Consumer - WSS Encrypt Strategy Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'wss-encrypt' node name to 'wss-encrypt-security-strategy'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "wss-encrypt",
            "newValue" : "wss-encrypt-security-strategy"
          }
        },
        {
          "stepDescriptor" : "Create 'key-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.CreateChildNode",
          "parameters" : {
            "name" : "key-store-configuration"
          }
        },
        {
          "stepDescriptor" : "Move 'tlsContext-ref' to 'key-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.MoveAttributeToChildNode",
          "parameters" : {
            "attribute" : "tlsContext-ref",
            "childNode" : "key-store-configuration"

          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:wss-decrypt",
      "taskDescriptor" : "Update Webservice Consumer - WSS Decrypt Strategy Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Rename 'wss-decrypt' node name to 'wss-decrypt-security-strategy'",
          "type" : "com.mulesoft.tools.migration.library.step.ReplaceStringOnNodeName",
          "parameters" : {
            "stringToReplace" : "wss-decrypt",
            "newValue" : "wss-decrypt-security-strategy"
          }
        },
        {
          "stepDescriptor" : "Create 'key-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.CreateChildNode",
          "parameters" : {
            "name" : "key-store-configuration"
          }
        },
        {
          "stepDescriptor" : "Move 'tlsContext-ref' to 'key-store-configuration' child node",
          "type" : "com.mulesoft.tools.migration.library.step.MoveAttributeToChildNode",
          "parameters" : {
            "attribute" : "tlsContext-ref",
            "childNode" : "key-store-configuration"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:key-store-configuration",
      "taskDescriptor" : "Update Key Store Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Get attributes from the global TLS Context and update the 'key-store' node with attributes: type;path;alias;keyPassword;password;algorithm",
          "type" : "com.mulesoft.tools.migration.library.step.GetAttributesFromReference",
          "parameters" : {
            "sourceReferenceAttribute" : "tlsContext-ref",
            "targetReferenceAttribute" : "name",
            "referenceNode" : "context",
            "referenceNodeNamespace" : "tls",
            "referenceNodeNamespaceUri" : "http://www.mulesoft.org/schema/mule/tls",
            "referenceChildNode" : "key-store",
            "referenceAttributes" : "type;path;alias;keyPassword;password;algorithm"
          }
        },
        {
          "stepDescriptor" : "Rename 'path' attribute to 'keyStorePath'",
          "type" : "com.mulesoft.tools.migration.library.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "path",
            "newName" : "keyStorePath"
          }
        },
        {
          "stepDescriptor" : "Delete 'tlsContext-ref' attribute",
          "type" : "com.mulesoft.tools.migration.library.step.DeleteAttribute",
          "parameters" : {
            "attributeName" : "tlsContext-ref"
          }
        }
      ]
    },
    {
      "xpathSelector" : "//wsc:trust-store-configuration",
      "taskDescriptor" : "Update Trust Store Configurations",
      "stepsDefinition" : [
        {
          "stepDescriptor" : "Get attributes from the global TLS Context and update the 'trust-store' node with attributes: type;path;password;algorithm;insecure",
          "type" : "com.mulesoft.tools.migration.library.step.GetAttributesFromReference",
          "parameters" : {
            "sourceReferenceAttribute" : "tlsContext-ref",
            "targetReferenceAttribute" : "name",
            "referenceNode" : "context",
            "referenceNodeNamespace" : "tls",
            "referenceNodeNamespaceUri" : "http://www.mulesoft.org/schema/mule/tls",
            "referenceChildNode" : "trust-store",
            "referenceAttributes" : "type;path;password;algorithm;insecure"
          }
        },
        {
          "stepDescriptor" : "Rename 'path' attribute to 'trustStorePath'",
          "type" : "com.mulesoft.tools.migration.library.step.UpdateAttributeName",
          "parameters" : {
            "attributeName" : "path",
            "newName" : "trustStorePath"
          }
        },
        {
          "stepDescriptor" : "Delete 'tlsContext-ref' attribute",
          "type" : "com.mulesoft.tools.migration.library.step.DeleteAttribute",
          "parameters" : {
            "attributeName" : "tlsContext-ref"
          }
        }
      ]
    }
  ]
}
